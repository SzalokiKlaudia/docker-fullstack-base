ServerRoot "/usr/local/apache2"
Listen 80
ServerName localhost

LoadModule mpm_event_module modules/mod_mpm_event.so
LoadModule unixd_module modules/mod_unixd.so
LoadModule authn_core_module modules/mod_authn_core.so
LoadModule authz_core_module modules/mod_authz_core.so
LoadModule authz_host_module modules/mod_authz_host.so
LoadModule dir_module modules/mod_dir.so
LoadModule mime_module modules/mod_mime.so
LoadModule log_config_module modules/mod_log_config.so
LoadModule rewrite_module modules/mod_rewrite.so
LoadModule headers_module modules/mod_headers.so
LoadModule proxy_module modules/mod_proxy.so
LoadModule proxy_fcgi_module modules/mod_proxy_fcgi.so

User daemon
Group daemon

ServerAdmin you@example.com
DocumentRoot "/var/www/public"

# Performance tuning
KeepAlive On
MaxKeepAliveRequests 100
KeepAliveTimeout 5

# MPM event tuning
<IfModule mpm_event_module>
    StartServers             2
    MinSpareThreads         25
    MaxSpareThreads         75
    ThreadsPerChild         25
    MaxRequestWorkers      150
    MaxConnectionsPerChild   0
</IfModule>

# Enable file caching
<IfModule mod_cache.c>
    CacheQuickHandler off
</IfModule>

<Directory "/var/www/public">
    AllowOverride All
    Require all granted
    
    # Disable .htaccess lookups for performance (if not needed)
    # AllowOverride None
</Directory>

<FilesMatch "\.php$">
    SetHandler "proxy:fcgi://laravel-app:9000"
    # Connection pooling
    ProxyFCGIBackendType GENERIC
</FilesMatch>

DirectoryIndex index.php index.html

# Logging
ErrorLog /proc/self/fd/2
CustomLog /proc/self/fd/1 combined

TypesConfig conf/mime.types

# Compress responses
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/json
</IfModule>